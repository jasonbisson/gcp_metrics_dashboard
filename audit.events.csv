Tactic,Techniques,Description of Threat,Cloud Logging Query,Splunk query
Initial Access,Exploit Public-Facing Application,"Public IP assigned to Compute Engine. Applies to GCE, GKE, Dataproc","protoPayload.authorizationInfo.permission=""compute.subnetworks.useExternalIp""",
Initial Access,Exploit Public-Facing Application,Google Storage Bucket with IAM policy of allUsers,"protoPayload.authorizationInfo.permission=""storage.buckets.setIamPolicy"" AND protoPayload.serviceData.policyDelta.bindingDeltas.member=""allUsers""",
Initial Access,Exploit Public-Facing Application,Google Storage Bucket with IAM policy of allAuthenticatedUsers,"protoPayload.authorizationInfo.permission=""storage.buckets.setIamPolicy"" AND protoPayload.serviceData.policyDelta.bindingDeltas.member=""allAuthenticatedUsers""",
Initial Access,Exploit Public-Facing Application,Google Storage Object with IAM policy of allUsers,"protoPayload.authorizationInfo.permission=""storage.objects.update"" AND protoPayload.serviceData.policyDelta.bindingDeltas.member=""allUsers""",
Initial Access,Exploit Public-Facing Application,Google Storage Object with IAM policy of allAuthenticatedUsers,"protoPayload.authorizationInfo.permission=""storage.objects.update"" AND protoPayload.serviceData.policyDelta.bindingDeltas.member=""allAuthenticatedUsers""",
Initial Access,Exploit Public-Facing Application,Update Organizational Policy Constraint to allow external IPs,"protoPayload.authorizationInfo.permission=""orgpolicy.policy.set"" AND protoPayload.request.policy.constraint=""constraints/compute.vmExternalIpAccess"" AND protoPayload.request.policy.listPolicy.allValues=""ALLOW""",
Initial Access,Exploit Public-Facing Application,Ingress firewall rule open to 0.0.0.0/0,"protoPayload.authorizationInfo.permission=""compute.firewalls.create"" AND protoPayload.request.direction=""INGRESS"" AND protoPayload.request.sourceRanges=""0.0.0.0/0""",
Initial Access,Exploit Public-Facing Application,Egress Firewall rule open to 0.0.0.0/0,"protoPayload.authorizationInfo.permission=""compute.firewalls.create"" AND protoPayload.request.direction=""EGRESS"" AND protoPayload.request.destinationRanges=""0.0.0.0/0""",
Initial Access,Exploit Public-Facing Application,Exteral IP address created,"protoPayload.authorizationInfo.permission=""compute.globalAddresses.create""",
Initial Access,Exploit Public-Facing Application,Monitor Organizational Policy Constraint for Load Balancer options,"protoPayload.authorizationInfo.permission=""orgpolicy.policy.set"" AND protoPayload.request.policy.constraint=""constraints/compute.restrictLoadBalancerCreationForTypes""",
Initial Access,Exploit Public-Facing Application,TCP/UDP Load Balancer with external scheme,,
Initial Access,Exploit Public-Facing Application,Creating a HTTP/HTTPS Premium Global Load Balancer,"protoPayload.authorizationInfo.permission=""compute.globalForwardingRules.create""",
Initial Access,Exploit Public-Facing Application,Cloud Shell Enabled,"protoPayload.metadata.event.parameter.value=""Cloud Shell Settings enable_cloud_shell_access"" AND protoPayload.metadata.event.parameter.value=""true""",
Initial Access,Exploit Public-Facing Application,OS Login allowing users to access VM instances outside of your organization,"protoPayload.metadata.event.parameter.value=""OS Login External User Settings allow_external_user"" AND protoPayload.metadata.event.parameter.value=""true""",
Initial Access,Trusted Relationship,Service Account created for SAAS provider,"protoPayload.authorizationInfo.permission=""iam.serviceAccounts.create""",
Initial Access,Trusted Relationship,Service Account Key created,"protoPayload.authorizationInfo.permission=""iam.serviceAccountKeys.create""",
Initial Access,Trusted Relationship,Monitor Organizational Policy Constraint to allow creation of Service Accounts,"protoPayload.authorizationInfo.permission=""orgpolicy.policy.set"" AND protoPayload.request.policy.constraint=""constraints/iam.disableServiceAccountCreation""",
Initial Access,Trusted Relationship,Monitor Organizational Policy Constraint to allow creation of Service Accounts Keys,"protoPayload.authorizationInfo.permission=""orgpolicy.policy.set"" AND protoPayload.request.policy.constraint=""constraints/iam.disableServiceAccountKeyCreation"" ",
Initial Access,Trusted Relationship,Update VPC Service Control Perimeter,"protoPayload.serviceName=""accesscontextmanager.googleapis.com"" AND protoPayload.authorizationInfo.permission=""accesscontextmanager.servicePerimeters.update""",
Initial Access,Trusted Relationship,Delete VPC Service Control Perimeter,"protoPayload.serviceName=""accesscontextmanager.googleapis.com"" AND protoPayload.authorizationInfo.permission=""accesscontextmanager.servicePerimeters.delete""",
Initial Access,Valid Accounts,Monitor succesful login events,"protoPayload.serviceName=""login.googleapis.com"" AND protoPayload.metadata.event.eventName=""login_success""",
Initial Access,Valid Accounts,Monitor failed login events,"protoPayload.serviceName=""login.googleapis.com"" AND protoPayload.metadata.event.eventName=""login_failure""",
Initial Access,Valid Accounts,Monitor password changes,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.metadata.event.eventName=""CHANGE_PASSWORD""",
Initial Access,Valid Accounts,Monitor for multi factor login for accounts with super admin role,"protoPayload.serviceName=""login.googleapis.com"" AND protoPayload.metadata.event.eventName=""login_verification""",
Initial Access,Valid Accounts,Monitor logout events,"protoPayload.serviceName=""login.googleapis.com"" AND protoPayload.metadata.event.eventName=""logout""",
Initial Access,Valid Accounts,Super Admin role assigned to account,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.metadata.event.eventName=""ASSIGN_ROLE"" AND protoPayload.metadata.event.parameter.value=""_SEED_ADMIN_ROLE""",
Initial Access,Valid Accounts,Super Admin role unassigned to account,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.metadata.event.eventName=""UNASSIGN_ROLE"" AND protoPayload.metadata.event.parameter.value=""_SEED_ADMIN_ROLE""",
Initial Access,Valid Accounts,Monitor any role changes made in the admin console,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.metadata.event.eventName=""ASSIGN_ROLE""",
Initial Access,Valid Accounts,Monitor users created,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.methodName=""google.admin.AdminService.createUser""",
Initial Access,Valid Accounts,Monitor user deleted,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.methodName=""google.admin.AdminService.deleteUser""",
Initial Access,Valid Accounts,Monitoring 2 Step settings,"protoPayload.serviceName=""admin.googleapis.com"" AND protoPayload.metadata.event.eventName=""ENFORCE_STRONG_AUTHENTICATION"" ",
Initial Access,Valid Accounts,Monitor adding a user to a group,"protoPayload.authorizationInfo.permission=""cloudidentity.membership.update"" AND protoPayload.metadata.membershipDelta.roleDeltas.action=""ADD""",
Initial Access,Valid Accounts,Monitor deleting user from a group,"protoPayload.authorizationInfo.permission=""cloudidentity.membership.update"" AND protoPayload.metadata.membershipDelta.roleDeltas.action=""REMOVE""",
Initial Access,Valid Accounts,GCP Organizational Admin role removed,"protoPayload.authorizationInfo.permission=""resourcemanager.organizations.setIamPolicy"" AND protoPayload.serviceData.policyDelta.bindingDeltas.role=""roles/iam.organizationRoleAdmin"" AND protoPayload.serviceData.policyDelta.bindingDeltas.action=""REMOVE""",
Initial Access,Valid Accounts,GCP Organizational Admin role added,"protoPayload.authorizationInfo.permission=""resourcemanager.organizations.setIamPolicy"" AND protoPayload.serviceData.policyDelta.bindingDeltas.role=""roles/resourcemanager.organizationAdmin"" AND protoPayload.serviceData.policyDelta.bindingDeltas.action=""ADD""",